SQL结构化查询语言

不同数据库系统之间的SQL不能完全相互通用

SQL注入是常见的Web安全漏洞

SQL注入基础

* 漏洞原理

  通过用户可控的参数中注入SQL语法, 破坏原有的SQL结构

  达到编写程序时意料之外结果的攻击行为

  成因: 2个原因叠加

  1. 程序编写者处理程序和数据库交互时, 使用字符串拼接的方式构造SQL语句
  2. 未对用户可控参数进行足够的过滤, 就将参数的内容直接拼接到SQL语句中

* 注入点可能存在的位置

  Web应用中获取用户数据的地方, 只有带有数据库查询, 都有存在SQL注入的可能性

  @ GET数据

  @ POST数据

  @ HTTP头部 (HTTP请求报文其他字段)

  @ Cookie数据

  ...    

  GPC (GET POST Cookie)

* 漏洞的危害

  攻击者利用SQL注入漏洞, 获取数据库中的多种信息(例如: 管理员后台密码)

  从而脱取数据库中的内容(脱库)

  特别情况下, 还可以修改数据库内容或者插入内容到数据库

  如果数据库权限分配存在问题, 或者数据库本身存在缺陷, 还有可能通过SQL注入漏洞直接获取wellshell或者服务器系统权限

  mof | udf 提权

* 分类

  SQL漏洞根据不同的标准, 有不同的分类

  * 从**数据类型**分类来看, SQL注入分为**数字型**和**字符型**

    数字型: 拼接到SQL语句中是以数字形式出现的, 即数据两边没有被单双引号括起来

    字符型注入正好相反

  * 根据**注入手法**分类, 大致可分以下5个类别

    @ UNION query SQL injection (可联合查询注入)

    @ Error-based SQL injection(报错型注入)

    盲注: 看不见数据库回显

    @ Boolean-based blind SQL injection(布尔型注入)  布尔盲注

    @ Time-base blind SQL injection(基于时间延迟注入)   延时

    @ Stacked queries SQL injection(可多语句查询注入)

* 注入点的判断

  在疑似注入点的连接或参数后面尝试提交以下数据

  1. url查询参数的变化  ?id=35 +1/-1

     SELECT * FROM tbName WHERE id=$id

  2. 字符还是数字   ?id=35'

     SELECT * FROM tbName WHERE id=$id'



MYSQL

​	@ 注释

​	mysql 数据库的注释大概以下几种

​	#

​	--  (杠杠空格)

​	/*   */

​	/*!  */   内联查询

​	@ mysql 元数据库information_schema

```
information_schem(元数据库)
	|
	`--tables(存储表信息的表)
	|	|
	|	`--table_name   表名
	|	|
	|	`--table_schema 表所属的数据库名
	|
    `--columns(存储字段信息的表)
    	|
    	`--column_name  字段名
    	|
    	`--table_name   字段所属的表名
    	|
    	`--table_name   字段所属的数据库名
```

​	@ MYSQL 常用函数与参数

```
= > >= <= < <>          比较运算符
and or not              逻辑运算符
version()               mysql数据库版本
database()              当前数据库名
user()					用户名
current_user()			当前用户名
system_user()			系统用户名
@@datadir				数据库路径
@@version_compile_os	操作系统版本

length()				返回字符串的长度
substring()				截取字符串
substr()
mid()
	参数 1. 截取的字符串
	参数 2. 截取的起始位置, from 1 to ...
	参数 3. 长度

left()					从左侧开始取指定字符个数(包括.)的字符串
concat()				不用分隔符的连接字符串
concat_ws()				用分隔符的连接字符串
group_concat()			连接一个组的字符串(不同record的字符放到同一行)

ord()					返回ASCII码
ascii()

hex()					将字符串转换为十六进制
unhex()					hex()的逆向操作
md5()					返回md5值
floor(x)				返回不大于x的最大整数
round(x)				返回参数x接近的整数
rand()					返回0-1之间的随机浮点数

load_file()				读取文件, 并返回文件内容作为一个字符串

sleep()					睡眠时间为指定的秒数
if(条件,truedo,falsedo)  if判断
find_in_set()			返回字符串在字符串列表中的位置
benchmark()				指定语句执行的次数
name_const()			返回表(table)作为结果

true --> 1
false--> 0
```

四大基本手法

​	@ 联合查询

​	@ 报错注入

​	@ 布尔盲注

​	@ 延时注入

