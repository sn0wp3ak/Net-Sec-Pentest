渗透测试的对象:

* 网络
* 系统
* 应用

黑盒测试

白盒测试:

* 充分了解被测试单位的内部资料
* 测试步骤与黑盒不相上下
* 技术门槛全面低于黑盒

黑盒报告市场价格通常高于白盒测试

风险等级: 

* 高
* 中
* 低
* 信息泄露

**脆弱性评估与渗透测试**

安全测试方法论

* 开放式 Web 应用程序安全项目

  Open Web Application Security Project

  OWASP    [http:/www.owasp.org.cn/]

  @   测试指南

  [https://owasp.org/www-project-web-security-testing-guide/]

  @  开发人员指南

  [https://wiki.owasp.org/index.php/OWASP_Guide_Project]

  @  代码审查指南 !!!

  OWASP  Top 10

  Web 十大安全漏洞

  [https://owasp.org/www-project-top-ten/]

* 通用缺陷列表 CWE

  Common Weakness Enumeration

  [https://cwe.mitre.org/

  CWE-79: XSS漏洞

  [https://cwe.mitre.org/data/definitions/79.html]

  CWE-89: SQLi

  [https://cwe.mitre.org/data/definitions/89.html]

* 通用漏洞与披露 CVE

  Common Vulnerabilities and Exposures

  [https://cve.mitre.org/]  

  [http://cve.scap.org.cn/]    中国区

  ~  MS17-010   微软17年发布的第10个安全公告

  ​	微软是KB开头的补丁

  ~  S2-053  (Struts2)  Apache  Struts2 的第53个安全公告

* 其他方法论

  @  开源安全测试方法论  OSSTMM

  Open Source Security Testing Methodology Manual

  @  信息系统安全评估框架  ISSAF

  Information Systems Security Assessment Framework

  @   Web 应用安全联合威胁分类  WASC-TC

  Web Application Security Consortium Threat Classification

  

**PTES**  The penetration testing execution standard  渗透测试执行标准

7个阶段

1-事前互动

2-情报搜集

3-威胁建模

4-漏洞分析

5-漏洞利用

6-深度利用

7-书面报告

@主要特点优势

PTES主要特性和优势

1-全面的渗透测试框架 [涵盖技术和其他方面, 例如: 范围蔓延(scope creep), 报告, 渗透人员保护自身的方法]

2-介绍了多数测试任务的具体方法, 指导准确测试目标系统的安全状态

3-汇聚了多名日行一"渗"的渗透测试专家的丰富经验

4-包含最常用以及罕见的相关技术

5-浅显易懂, 可以根据测试工作的需要对相关测试步骤进行调整

**通用渗透测试框架**

典型 (管理者角度)

阶段

1-范围界定

```
# 典型因素
1.测试对象是什么?
2.应当采取何种测试方式?
3.有哪些在测试过程中需要满足的条件?
4.哪些因素可能会限制测试执行的过程?
5.需要多久才能完成测试?
6.此次测试应当达成什么样的任务目标?
```

2-信息搜集

```
从公开资源获取测试目标的相关信息
互联网渠道: 论坛|公告板|新闻组|媒体文章|博客|社交网络|其他商业或非商业性的网站
搜索引擎
信息主要包括: DNS服务器, 路有关系, whois数据库, 电子邮件地址, 电话号码, 个人信息以及用户账户
```

3-目标识别

```
识别目标的网络状态, 操作系统, 网络架构
完整的展现目标网络里各种联网设备或技术的完整关系, 帮助测试人员枚举网络的各种服务
```

4-服务枚举

```
根据前面各个阶段的成果, 进一步找出目标系统中总所有开放的端口
通过端口来列出目标系统上运行的服务
进一步找出目标网络基础设施中可能存在的漏洞
```

5-漏洞映射

```
根据已发现的开放端口和服务程序, 查找,分析目标系统中存在的漏洞
采用自动和手动两种不同的测试方法结合起来
```

6-社会工程学

```
目标网络没有直接的入口, 欺骗的艺术将起到抛砖引玉的重要作用
对目标组织中的人员进行定向攻击, 帮助找到渗透目标系统的入口
例如: 诱使安装后门恶意程序; 伪装管理员通过电话要求用户账户信息; 发送钓鱼邮件劫持用户的账户等等...
研究目标人员的心理
注意法律条款
```

7-漏洞利用

```
发现漏洞后, 可以使用现有的漏洞利用程序对目标进行渗透
主要任务: 控制目标系统
分三步: 攻击前, 攻击, 攻击后
```

8-权限提升

```
获取目标系统的控制权限是渗透成功的标志
接下来, 根据所拥有的访问权限, 在被测试系统中自由发挥
也可以使用适用于目标系统的本地漏洞来提升自己的权限
获取超级用户root/administrator或者系统级权限
以该主机为跳板, 进一步攻击局域网
攻击是受限制的, 或不受限制的, 要根据范围界定(事前商议)
具体: 嗅探手段拦截网络数据包, 破解各种服务的密码, 在局域网中使用网络欺骗手段
最终目的: 获取目标系统的最高访问控制权限
```

9-访问维护

```
在一段时间内维持对目标系统的访问权限
如: 安装后门将节省重新渗透所消耗的大量时间
访问维护将节约获取目标系统访问权限所需要的时间, 花费和资源
通过秘密的通信隧道, 在既定的时间内维持对目标的访问权限
隧道往往基于特定协议, 代理, 或者点对点方式的后门程序
清楚的展示入侵人员在对目标系统实施攻击时隐藏行踪的具体方法
```

0-文档报告

```
记录, 报告并且现场演示那些已经被识别,验证和利用的安全漏洞
被测试单位的技术和管理团队会检查渗透测试时使用的方法, 并会根据这些文档修补当前所有存在的安全漏洞
从道德角度, 报告十分重要
为了帮助被测试单位各部门理解, 可能需要撰写不同措辞的书面报告
报告还可以用来获取和对比渗透测试前后系统的完整性
```

**简化渗透测试流程**

@ 明确目标

{确定范围|确定规则|确定需求}

@ 信息搜集

{基础信息|系统信息|应用信息|人员信息|防护信息}

@ 漏洞探测

{系统漏洞|Web服务漏洞|Web应用漏洞|其他端口|通信安全}

@ 漏洞验证

{手动验证|工具验证|实验验证}

@ 漏洞利用

{定制EXP|防御绕过|进一步渗透|清理痕迹}

@ 形成报告

{整理结果|补充介绍|修复建议}



**黑客攻击的一般过程**

```
	   	   /--破坏攻击								   /--远程控制
踩点--扫描--|           /--获得控制权--清除痕迹--安装后门--|--转移目标
		   \--渗透攻击--|	  |                        \--窃密破坏
			           \--获得访问权
```

