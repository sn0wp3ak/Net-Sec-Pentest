**什么是脚本? 干什么用的?**

类似windows的批处理bat

重定向  覆盖+追加

1. 声明用什么命令解释器执行

   ```
   #!/bin/bash
   ```

2. 脚本信息

3. 脚本内容

给与脚本可执行权限

```
chmod +x 脚本文件
```

运行 

```
./脚本文件
```

变量赋值

```
A="hello"
echo $A
>hello
```

交互式赋值

```
read -p "please input ipaddr:" IP
> please input ipaddr:10.1.1.100
echo $IP
>10.1.1.100
```

if判断

```
if 条件
then 成立执行的语句
else 不成立执行的语句
fi
```

```
#!/bin/bash
if [3 -lt 5]
then 
	echo "yes"
else 
	echo "no" 
fi
```

```
#!/bin/bash
read -p "please input a num:" NUM
if [$NUM -lt 10]
then 
	echo "lt10"
elif [$NUM -gt 10]
then
	echo "gt10"
else 
	echo "eq10"
```

**循环语句**

for      根据取值范围循环

while  根据条件循环

```shell
for 变量 in 取值列表
do
	子语句
done
```

```shell
# 循环输出1~10
# 根据赋值变量的次数进行子语句的循环
for i in {1..10}
do
	echo $i
done
```

```shell
#!/bin/bash
NUM=1
while [$NUM -lt 11]
do 
	echo $NUM
	let NUM++
done
```

```shell
# ping 10.0.110网段中的主机, ping通输出绿色up, ping不通输出红色down
#!/bin/bash
NET=10.0.110.
for IP in {1..254}
do 
	if `ping -c2 -i0.2 -W2 $NET$IP &> /dev/null`
	then
		echo -e "$NET$IP is \033[32mup\033[0m"
	else
		echo -e "$NET$IP is \033[31mdown\033[0m"
	fi
done
```

```shell
# ping 10.0.110网段中的主机, ping通输出绿色up, ping不通输出红色down
#!/bin/bash
NET=10.0.110.
IP=1
while [$IP -lt 255]
do 
	if `ping -c2 -i0.2 -W2 $NET$IP &> /dev/null`
	then
		echo -e "$NET$IP is \033[32mup\033[0m"
	else
		echo -e "$NET$IP is \033[31mdown\033[0m"
	fi
	let IP++
done
```

**case语句**

```
./case.sh centos
>centos
./case.sh redhat
>redhat
./case.sh xxxx
>useage case.sh {redhat|centos}
```

```shell
case $1 in   # $1 第一个输入参数
redhat)
	echo "redhat"
	;;
centos)
	echo "centos"
	;;
*)  # 除以上方案之外的所有输入
	echo "useage $0 {redhat|centos}"   # $0脚本文件名
esac
```

```shell
case 变量 in 
模式1)
	子语句
	;;
模式2)
	子语句
	;;	
*)
	子语句
esac
```

**函数**

```
A(){
echo ok
echo yes
return 0
}
```

```shell
redhat(){
	echo redhat
	return 0
}
centos(){
	echo centos
	return 0
}
case $1 in   # $1 第一个输入参数
redhat)
	redhat
	;;
centos)
	centos
	;;
*)  # 除以上方案之外的所有输入
	echo "useage $0 {redhat|centos}"   # $0脚本文件名
esac
```

**实例: nginx图形界面开机自启动脚本**

```
cd /etc/init.d
vim nginxd
chmod +x nginxd
```

```shell
#!/bin/bash
# chkconfig: - 84 18
# description: nginx script
# 变量赋值
nginx=/usr/local/nginx/sbin/nginx
# 定义各功能函数
start(){
	echo "nginx starting ... [ ok ]"
	$nginx
}
status(){
	if `ss -antpl | grep nginx > /dev/null`
	then
		echo "nginx is start"
	else
		echo "nginx is stop"
	fi
}
stop(){
	echo "nginx is stoping ... [ ok ]"
	$nginx -s stop
}
# case 语句
case $1 in
start)
	start
	;;
status)
	status
	;;
stop)
	stop
	;;
restart)
	stop
	start
	;;
*)
	echo "Useage $0 {start|stop|status|restart}"
esac
```

```
chkconfig --add nginxd  # 把自己写的nginxd添加到chkconfig列表中
```

```
chkconfig --level 5 nginxd on  # 图形级别开机自启动
```

